name: Firestore Catalogue Upload

on:
  workflow_dispatch:   # manual trigger from GitHub UI

jobs:
  upload:
    runs-on: ubuntu-latest

    permissions:
      contents: read
      id-token: write

    steps:
      - name: Authenticate to Google Cloud
        id: auth
        uses: google-github-actions/auth@v2
        with:
          credentials_json: ${{ secrets.GCP_SA_KEY }}
          token_format: access_token

      - name: Show full Bearer Token
        run: |
          echo "Access token:"
          echo "${{ steps.auth.outputs.access_token }}"

      - name: Create Firestore document
        run: |
          curl -X POST \
          "https://firestore.googleapis.com/v1/projects/site-9686c/databases/(default)/documents/Catalogue?documentId=Moto%20G60" \
          -H "Authorization: Bearer ${{ steps.auth.outputs.access_token }}" \
          -H "Content-Type: application/json" \
          -d '{
            "fields": {"model":"Motorola Edge 40 Pro","architecture":"ARMv9","aspectRatio":"20:9","resolution":"1080x2400","audioFeatures":"Stereo speakers, Dolby Atmos","audioJack":"No","availableStorage":"256GB","battery":"Li-Po","batteryCapacity":"5000mAh","batteryRemovable":"No","batteryTalkTime":"30h","batteryType":"Lithium Polymer","benchMarks":"AnTuTu 800,000","bezelLessDisplay":"Yes","bluetooth":"5.3","chipset":"Qualcomm Snapdragon 8+ Gen 2","colours":"Obsidian Black, Sapphire Blue, Crimson Red","comparePrices":"$699 - $799","cpu":"Octa-core (1x3.2GHz Cortex-X3 & 3x2.8GHz Cortex-A715 & 4x2.0GHz Cortex-A510)","customUi":"Motorola UI 5.0","dimensions":"162.5 x 74.5 x 8.2 mm","displayType":"OLED","expandable":"No","expertRating":"Premium flagship with strong performance, excellent camera, and solid battery life.","fingerprintType":"Optical","fingerprintPosition":"Under display","fingerprintSensor":"Integrated","fmRadio":"No","frontAutofocus":"Yes","frontCamera":"50 MP","frontCameraSetup":"Single 50MP sensor, f/2.0 lens, 1.0µm pixel size, spec score 85","frontFlash":"LED","frontResolution":"50MP","frontVideo":"4K@30fps","gps":"GPS, GLONASS, BDS, Galileo","graphics":"Adreno 770","hdr":"HDR10+","imageURL":"https://example.com/motorola-edge-40-pro.jpg","internalMemory":"256GB","launchDate":"2024-04-18","loudSpeaker":"Stereo","material":"Aluminum frame, Gorilla Glass Victus 2","networkSupport":"5G Sub‑6 / mmWave","nfc":"Yes","operatingSystem":"Android 14","otg":"Yes","otherSensors":"Accelerometer, Gyroscope, Proximity, Ambient Light, Barometer","peakBrightness":"1300 nits","performance":"High","pixelDensity":"405 ppi","priceList":"$699","quickCharging":"65W wired, 30W wireless","ram":"12GB","rearAutoFocus":"Yes","rearCamera":"108 MP","rearCameraFeatures":"OIS, PDAF, Laser AF, HDR","rearCameraSetup":"Triple 108MP (f/1.8, 1.0µm) + 12MP ultra-wide (f/2.2) + 8MP telephoto (f/2.4, 3x optical zoom), spec score 92","rearFlash":"Dual LED","rearImageResolution":"108MP","rearOis":"Yes","rearResolution":"108MP","rearSettings":"Pro mode, Night mode, Portrait, AI Scene Detection","rearShootingModes":"Single, Burst, Panorama, Night, Pro","rearVideoFeatures":"8K@24fps, 4K@60fps, Super Steady","rearVideoRecording":"8K@24fps, 4K@60fps","refreshRate":"120Hz","resolution":"1080x2400","ruggedness":"IP68 water and dust resistance","sar":"0.85 W/kg (head), 0.65 W/kg (body)","screenProtection":"Gorilla Glass Victus 2","screenSize":"6.7 inches","screenToBodyRatio":"94%","sim1":"Nano SIM, 2G: GSM 850/900/1800/1900, 3G: HSDPA 850/900/1700/1900/2100, 4G: LTE B1/B3/B5/B7/B8/B20/B28, 5G: n1/n3/n5/n7/n28/n78/n79","sim2":"Nano SIM, 2G: GSM 850/900/1800/1900, 3G: HSDPA 850/900/1700/1900/2100, 4G: LTE B1/B3/B5/B7/B8/B20/B28, 5G: n1/n3/n5/n7/n28/n78/n79","simSize":"Nano","simSlot":"Dual SIM (Nano-SIM, dual stand-by)","stereoSpeakers":"Yes","storage":"256GB UFS 3.1","touchScreen":"Capacitive, multi-touch","usbConnectivity":"USB Type-C","usbType":"USB 3.2 Gen 1 Type-C","userRatings":"4.5/5","voLte":"Yes","waterproofing":"IP68","weight":"189g","wifi":"Wi‑Fi 6E","wifiFeatures":"802.11 a/b/g/n/ac/ax, Dual-band, Wi‑Fi Direct, Hotspot"}
          }'
