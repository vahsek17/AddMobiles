name: Firestore Catalogue Upload

on:
  workflow_dispatch:   # manual trigger from GitHub UI

jobs:
  upload:
    runs-on: ubuntu-latest

    permissions:
      contents: read
      id-token: write

    steps:
      - name: Authenticate to Google Cloud
        id: auth
        uses: google-github-actions/auth@v2
        with:
          credentials_json: ${{ secrets.GCP_SA_KEY }}
          token_format: access_token

      - name: Show full Bearer Token
        run: |
          echo "Access token:"
          echo "${{ steps.auth.outputs.access_token }}"

      - name: Create Firestore document
        run: |
          curl -X POST \
          "https://firestore.googleapis.com/v1/projects/site-9686c/databases/(default)/documents/Catalogue?documentId=Moto%20G60" \
          -H "Authorization: Bearer ${{ steps.auth.outputs.access_token }}" \
          -H "Content-Type: application/json" \
          -d '{
            "fields":{"model":{"stringValue":"Motorola Edge 40 Pro"},"architecture":{"stringValue":"ARMv9"},"aspectRatio":{"stringValue":"20:9"},"resolution":{"stringValue":"1080x2400"},"audioFeatures":{"stringValue":"Stereo speakers, Dolby Atmos"},"audioJack":{"booleanValue":false},"availableStorage":{"integerValue":"256"},"battery":{"stringValue":"Li-Po"},"batteryCapacity":{"integerValue":"5000"},"batteryRemovable":{"booleanValue":false},"batteryTalkTime":{"integerValue":"24"},"batteryType":{"stringValue":"Li-Po"},"benchMarks":{"integerValue":"850000"},"bezelLessDisplay":{"booleanValue":true},"bluetooth":{"stringValue":"5.3"},"chipset":{"stringValue":"Qualcomm Snapdragon 8 Gen 3"},"colours":{"stringValue":"Obsidian Black, Sapphire Blue, Crimson Red"},"comparePrices":{"stringValue":"https://www.motorola.com/compare"},"cpu":{"stringValue":"Octa-core (1x3.2GHz Cortex-X4 & 3x2.8GHz Cortex-A720 & 4x2.0GHz Cortex-A520)"},"customUi":{"stringValue":"Motorola UI 5.0"},"dimensions":{"stringValue":"162.5 x 73.5 x 8.0 mm"},"displayType":{"stringValue":"OLED"},"expandable":{"booleanValue":false},"expertRating":{"doubleValue":"4.5"},"fingerprintType":{"stringValue":"Optical"},"fingerprintPosition":{"stringValue":"Under display"},"fingerprintSensor":{"booleanValue":true},"fmRadio":{"booleanValue":false},"frontAutofocus":{"booleanValue":true},"frontCamera":{"stringValue":"50 MP"},"frontCameraSetup":{"stringValue":"Single"},"frontFlash":{"booleanValue":true},"frontResolution":{"integerValue":"50"},"frontVideo":{"stringValue":"4K@30fps"},"gps":{"stringValue":"A-GPS, GLONASS, BDS, Galileo"},"graphics":{"stringValue":"Adreno 770"},"hdr":{"booleanValue":true},"imageURL":{"stringValue":"https://example.com/motorola_edge_40_pro.jpg"},"internalMemory":{"integerValue":"256"},"launchDate":{"stringValue":"2024-09-15"},"loudSpeaker":{"booleanValue":true},"material":{"stringValue":"Aluminum frame, glass front/back"},"networkSupport":{"stringValue":"5G, 4G LTE, 3G"},"nfc":{"booleanValue":true},"operatingSystem":{"stringValue":"Android 14"},"otg":{"booleanValue":true},"otherSensors":{"stringValue":"Accelerometer, Gyroscope, Proximity, Compass"},"peakBrightness":{"integerValue":"1300"},"performance":{"stringValue":"High"},"pixelDensity":{"integerValue":"425"},"priceList":{"stringValue":"$799"},"quickCharging":{"booleanValue":true},"ram":{"integerValue":"12"},"rearAutoFocus":{"booleanValue":true},"rearCamera":{"stringValue":"108 MP"},"rearCameraFeatures":{"stringValue":"OIS, PDAF, Laser AF"},"rearCameraSetup":{"stringValue":"Triple (108MP main, 13MP ultra-wide, 5MP macro)"},"rearFlash":{"booleanValue":true},"rearImageResolution":{"integerValue":"108"},"rearOis":{"booleanValue":true},"rearResolution":{"integerValue":"108"},"rearSettings":{"stringValue":"Pro mode, Night mode, Portrait"},"rearShootingModes":{"stringValue":"Auto, Pro, Night, Portrait, Panorama"},"rearVideoFeatures":{"stringValue":"8K@24fps, 4K@60fps, HDR10+"},"rearVideoRecording":{"stringValue":"8K@24fps, 4K@60fps"},"refreshRate":{"integerValue":"120"},"displayResolution":{"stringValue":"1080x2400"},"ruggedness":{"stringValue":"IP68"},"sar":{"doubleValue":"0.99"},"screenProtection":{"stringValue":"Gorilla Glass Victus 2"},"screenSize":{"doubleValue":"6.7"},"screenToBodyRatio":{"doubleValue":"92.5"},"sim1":{"stringValue":"Nano-SIM"},"sim2":{"stringValue":"Nano-SIM"},"simSize":{"stringValue":"Nano"},"simSlot":{"stringValue":"Hybrid Dual SIM"},"stereoSpeakers":{"booleanValue":true},"storage":{"integerValue":"256"},"touchScreen":{"booleanValue":true},"usbConnectivity":{"stringValue":"USB Type-C"},"usbType":{"stringValue":"USB 3.2 Gen 1"},"userRatings":{"doubleValue":"4.4"},"voLte":{"booleanValue":true},"waterproofing":{"stringValue":"IP68"},"weight":{"doubleValue":"189"},"wifi":{"stringValue":"Wi-Fi 6E"},"wifiFeatures":{"stringValue":"802.11ax, Dual-band, Wi-Fi Direct"}}}
          }'
